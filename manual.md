# JustFit v0.0.2 手动测试指南

本文档用于手动测试 JustFit v0.0.2 版本的功能。

## 测试环境

测试环境配置在 `.env` 文件中，包含以下信息：

- vCenter 连接信息
- 数据库路径
- 日志级别

## 测试检查清单

### 1. 连接管理测试

#### 1.1 创建连接

- [ ] 输入正确的连接信息，成功创建连接
- [ ] 输入重复的连接名称，显示错误提示
- [ ] 输入无效的 IP 地址，显示验证错误
- [ ] 输入无效的端口号，显示验证错误
- [ ] 密码在数据库中是否正确加密存储

#### 1.2 测试连接

- [ ] 对已存在的连接进行测试，显示连接状态
- [ ] 对无效的连接进行测试，显示错误信息
- [ ] 连接成功后状态更新为 "connected"

#### 1.3 列出连接

- [ ] 连接列表正确显示所有连接
- [ ] 每个连接显示正确的 VM 数量
- [ ] LastSync 时间正确显示

#### 1.4 更新连接

- [ ] 修改连接名称，保存成功
- [ ] 修改连接密码，凭据更新成功

#### 1.5 删除连接

- [ ] 删除连接后，列表中不再显示
- [ ] 删除连接后，相关的 VM 数据是否保留

### 2. 资源管理测试

#### 2.1 列出集群

- [ ] 集群列表正确显示
- [ ] 集群的 TotalMemoryGB 正确计算
- [ ] NumHosts 和 NumVMs 数量正确

#### 2.2 列出主机

- [ ] 主机列表正确显示
- [ ] MemoryGB 正确计算（MB / 1024）
- [ ] CPU 核心数正确显示

#### 2.3 列出虚拟机

- [ ] 虚拟机列表正确显示
- [ ] MemoryGB 正确计算（MB / 1024）
- [ ] PowerState 正确显示
- [ ] GuestOS 正确显示

#### 2.4 搜索功能

- [ ] 按名称搜索虚拟机，结果正确
- [ ] 按UUID搜索虚拟机，结果正确

#### 2.5 分页功能

- [ ] 第一页数据正确
- [ ] 翻页功能正常
- [ ] Total 数量正确

### 3. 数据采集测试

#### 3.1 创建采集任务

- [ ] 选择全部 VM 进行采集
- [ ] 选择部分 VM 进行采集
- [ ] 采集任务创建成功，显示任务 ID

#### 3.2 采集进度

- [ ] 进度条实时更新
- [ ] CurrentStep 正确显示当前步骤
- [ ] 完成后状态更新为 completed

#### 3.3 采集结果

- [ ] VM 数据正确保存到数据库
- [ ] CollectedVMs 数量与选择的一致
- [ ] 任务日志正确记录

### 4. 分析功能测试

#### 4.1 僵尸 VM 分析

- [ ] 创建僵尸 VM 分析任务
- [ ] 分析结果正确显示
- [ ] Confidence 分数合理
- [ ] Evidence 列表有意义

#### 4.2 Right Size 分析

- [ ] 创建 Right Size 分析任务
- [ ] 推荐的配置合理
- [ ] AdjustmentType 正确（none, up, down）
- [ ] RiskLevel 正确

#### 4.3 潮汐分析

- [ ] 创建潮汐分析任务
- [ ] Pattern 识别正确（daily, weekly, none）
- [ ] PeakHours 和 PeakDays 合理

#### 4.4 健康评分

- [ ] 创建健康评分任务
- [ ] OverallScore 在 0-100 范围内
- [ ] HealthLevel 正确（excellent, good, fair, poor）
- [ ] Recommendations 列表有意义

### 5. 仪表盘测试

#### 5.1 统计数据

- [ ] TotalVMs 数量正确
- [ ] TotalHosts 数量正确
- [ ] TotalClusters 数量正确
- [ ] ZombieCount 数量正确
- [ ] HealthScore 显示正确

#### 5.2 节省估算

- [ ] TotalSavings 格式正确（¥xxx/月）
- [ ] 估算公式合理

### 6. 告警功能测试

#### 6.1 告警列表

- [ ] 告警列表正确显示
- [ ] Severity 颜色正确区分
- [ ] Acknowledged 状态正确

#### 6.2 告警统计

- [ ] Total 数量正确
- [ ] Unacknowledged 数量正确
- [ ] BySeverity 分布正确

#### 6.3 标记告警

- [ ] 确认告警成功
- [ ] 取消确认成功

### 7. 任务管理测试

#### 7.1 任务列表

- [ ] 所有任务正确显示
- [ ] Status 颜色正确
- [ ] Progress 百分比正确

#### 7.2 任务详情

- [ ] 详情信息完整
- [ ] AnalysisResults 正确标记
- [ ] Result 数据正确

#### 7.3 任务日志

- [ ] 日志按时间排序
- [ ] Level 颜色正确
- [ ] Message 内容有意义

#### 7.4 停止/重试任务

- [ ] 停止运行中的任务成功
- [ ] 重试失败任务成功

### 8. 日志系统测试

#### 8.1 日志输出

- [ ] Debug 日志在调试模式下显示
- [ ] Info 日志正常显示
- [ ] Warn 日志用黄色标记
- [ ] Error 日志用红色标记

#### 8.2 结构化日志

- [ ] 日志包含时间戳
- [ ] 日志包含级别
- [ ] 日志包含服务名称
- [ ] 日志包含相关字段

### 9. 错误处理测试

#### 9.1 连接错误

- [ ] 连接超时显示友好提示
- [ ] 认证失败显示明确错误
- [ ] 网络不可达显示原因

#### 9.2 数据错误

- [ ] 数据不存在显示 "NOT_FOUND"
- [ ] 数据格式错误显示 "INVALID_INPUT"
- [ ] 数据库错误显示 "DATABASE_ERROR"

### 10. 性能测试

#### 10.1 大数据量

- [ ] 1000+ VM 列表加载时间 < 2s
- [ ] 分析任务执行时间合理
- [ ] 仪表盘加载时间 < 1s

#### 10.2 并发操作

- [ ] 同时创建多个采集任务
- [ ] 同时执行多个分析任务

## 测试结果记录

| 测试项 | 结果 | 备注 |
|--------|------|------|
| 连接管理 | ⬜ 通过 / ❌ 失败 | |
| 资源管理 | ⬜ 通过 / ❌ 失败 | |
| 数据采集 | ⬜ 通过 / ❌ 失败 | |
| 分析功能 | ⬜ 通过 / ❌ 失败 | |
| 仪表盘 | ⬜ 通过 / ❌ 失败 | |
| 告警功能 | ⬜ 通过 / ❌ 失败 | |
| 任务管理 | ⬜ 通过 / ❌ 失败 | |
| 日志系统 | ⬜ 通过 / ❌ 失败 | |
| 错误处理 | ⬜ 通过 / ❌ 失败 | |
| 性能测试 | ⬜ 通过 / ❌ 失败 | |

## 缺陷记录

| ID | 标题 | 严重程度 | 状态 |
|----|------|----------|------|
| 1 | | ⬜ P0 / ⬜ P1 / ⬜ P2 / ⬜ P3 | ⬜ 待处理 / ⬜ 已修复 / ⬜ 验证中 |
| 2 | | ⬜ P0 / ⬜ P1 / ⬜ P2 / ⬜ P3 | ⬜ 待处理 / ⬜ 已修复 / ⬜ 验证中 |

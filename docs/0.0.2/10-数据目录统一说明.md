# 数据目录统一说明

## 修改内容

简化了 `appdir` 模块，去除了开发/生产模式的区分，所有平台统一使用标准的用户数据目录。

## 各平台数据目录位置

| 平台 | 数据目录 | 说明 |
|------|----------|------|
| Windows | `%APPDATA%\justfit` | 例如: `C:\Users\xxx\AppData\Roaming\justfit` |
| macOS | `~/Library/Application Support/justfit` | 用户库下的应用支持目录 |
| Linux | `~/.local/share/justfit` | 遵循 XDG 数据目录标准 |

## 目录结构

```
justfit/                          # 数据根目录
├── justfit.db                     # SQLite 数据库
├── credentials.enc                # 加密的凭据文件
├── .key                          # 加密密钥
└── logs/                         # 日志目录
    ├── app.log                    # 应用日志
    └── task.log                   # 任务日志
```

## 环境变量

可以通过设置 `JUSTFIT_DATA_DIR` 环境变量来指定自定义的数据目录：

```bash
# Linux/macOS
export JUSTFIT_DATA_DIR=/path/to/custom/dir

# Windows
set JUSTFIT_DATA_DIR=D:\Custom\Path
```

## 迁移说明

如果您之前使用��是项目根目录的 `.justfit` 目录，数据需要迁移：

```bash
# 备份旧数据
cp -r .justfit/* ~/justfit_backup/

# 新版本会自动使用新目录
# 如需手动迁移数据库：
mv .justfit/justfit.db ~/.local/share/justfit/
```

## API 变更

### 移除的 API

- `IsDevMode(ctx interface{}) bool` - 不再需要
- `GetAppDataDir(ctx interface{})` - 改为 `GetAppDataDir()`
- `GetLogDir(ctx interface{})` - 改为 `GetLogDir()`
- `GetDBPath(ctx interface{})` - 改为 `GetDBPath()`
- `EnsureAppDirs(ctx interface{})` - 改为 `EnsureAppDirs()`
- `InitWithContext(ctx interface{})` - 改为 `Init()`

### 新的 API

```go
// 获取应用数据目录
func GetAppDataDir() (string, error)

// 获取日志目录
func GetLogDir() (string, error)

// 获取数据库路径
func GetDBPath() (string, error)

// 确保目录存在
func EnsureAppDirs() error

// 初始化（确保目录并返回路径）
func Init() (string, error)

// MustGet 系列方法（失败时 panic）
func MustGetAppDataDir() string
func MustGetLogDir() string
func MustGetDBPath() string
```

# 数据采集说明

## 采集流程

### 1. 创建连接

首先添加云平台连接信息：

**支持的平台**：
- VMware vCenter
- H3C UIS

**需要的信息**：
- 平台类型
- 服务器地址
- 用户名和密码

### 2. 创建采集任务

创建评估任务并配置采集参数：

**基本信息**：
- 任务名称
- 选择云平台连接
- 任务描述（可选）

**采集配置**：
- 虚拟机选择：全部采集或选择特定 VM
- 采集周期：性能指标采集的时间范围

**分析配置**：
- 选择评估模式（安全/节省/激进/自定义）
- 配置各项分析参数

### 3. 执行采集

启动任务后，系统自动执行：

1. **资源采集**：获取集群、主机、虚拟机信息
2. **性能采集**：定期采集 CPU、内存、磁盘、网络指标
3. **数据分析**：执行僵尸 VM、规格调整、潮汐检测、健康评分
4. **完成通知**：任务完成后生成通知

## 采集的数据类型

### 基础资源数据

| 数据类型 | 说明 | 来源 |
|---------|------|------|
| 集群信息 | 名称、数据中心、CPU/内存总量 | 云平台 API |
| 主机信息 | 名称、IP、CPU/内存、VM 数量 | 云平台 API |
| 虚拟机信息 | 名称、配置、IP、操作系统 | 云平台 API |

### 性能指标数据

| 指标类型 | 说明 | 采集频率 |
|---------|------|----------|
| CPU 使用率 | CPU 使用情况 | 每 20 秒 |
| 内存使用量 | 内存使用字节数 | 每 20 秒 |
| 磁盘读速率 | 磁盘读取速度 | 每 20 秒 |
| 磁盘写速率 | 磁盘写入速度 | 每 20 秒 |
| 网络接收速率 | 网络接收速度 | 每 20 秒 |
| 网络发送速率 | 网络发送速度 | 每 20 秒 |

**注意**：性能指标采集需要虚拟机处于开机状态。

## 任务状态说明

| 状态 | 说明 |
|------|------|
| **等待中** | 任务已创建，尚未开始 |
| **采集中** | 正在采集资源和性能数据 |
| **分析中** | 资源采集完成，正在执行分析 |
| **已完成** | 采集和分析全部完成 |
| **失败** | 任务执行出错 |
| **已取消** | 任务被用户取消 |

## 采集时间估算

采集时间取决于以下因素：

- 虚拟机数量
- 性能指标采集周期
- 网络延迟

**参考时间**：
- 10 台虚拟机，采集 1 天指标：约 5-10 分钟
- 50 台虚拟机，采集 7 天指标：约 20-30 分钟
- 100 台虚拟机，采集 30 天指标：约 1-2 小时

## 注意事项

### 权限要求

采集账户需要以下权限：

- **vCenter**：只读权限即可
- **H3C UIS**：只读权限即可

### 网络要求

- 确保网络连接稳定
- 建议在内网环境执行采集
- 大量数据采集可能需要较长时间

### 虚拟机状态

- 开机的虚拟机：采集完整信息（配置 + 性能指标）
- 关机的虚拟机：仅采集配置信息
- 断开连接的虚拟机：无法采集数据

### 数据隔离

- 每个任务的性能指标数据独立存储
- 删除任务不会影响其他任务的数据
- 可创建多个任务分别采集不同集群

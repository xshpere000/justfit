# JustFit 需求规格说明书

## 0. 文档信息

| 项目 | 内容 |
|------|------|
| 文档名称 | 需求规格说明书 (SRS) |
| 版本 | v1.0 |
| 日期 | 2026-02-07 |
| 项目版本 | v0.0.1 Beta |
| 适用范围 | 产品、研发、测试、交付 |
| 状态 | 待评审 |

## 1. 项目概述

### 1.1 项目背景

JustFit 是面向多云/虚拟化平台的资源优化工具，覆盖数据采集、清洗入库、智能分析与报告输出。目标是帮助用户识别僵尸虚拟机、优化资源配置（right size）、发现潮汐性工作负载，并评估平台整体健康度，形成量化结论与可执行建议。

### 1.2 项目目标

- 提供统一的多云/虚拟化平台资源采集能力
- 自动识别低效资源配置并提供优化建议
- 降低运维成本，提高资源利用率
- 提供可追溯、可解释的分析报告

### 1.3 版本范围

**v0.0.1 Beta 范围：**

| 功能模块 | 状态 | 说明 |
|---------|------|------|
| vCenter 数据采集 | 支持 | 仅支持 VMware vCenter |
| H3C UIS 数据采集 | 不支持 | 后续版本支持 |
| 僵尸 VM 检测 | 支持 | |
| Right Size 评估 | 支持 | |
| 潮汐检测 | 支持 | |
| 平台健康检测 | 支持 | |
| 报告导出 | 支持 | PDF/HTML/JSON |
| 自动执行变更 | 不支持 | 首期仅提供建议 |

## 2. 术语与定义

| 术语 | 定义 |
|------|------|
| 僵尸虚拟机 | 长期低负载或无业务活动的 VM，占用资源但价值较低 |
| Right Size | 将资源配置与实际使用相匹配的评估与建议 |
| 潮汐性 | 负载在周期性时间窗内呈明显峰谷波动 |
| 平台健康度 | 集群/主机在资源均衡、超配、热点上的综合评分 |
| vCenter | VMware vCenter Server，虚拟化管理平台 |
| H3C UIS | 新华三统一基础架构系统 |

## 3. 用户角色与权限

| 角色 | 描述 | 主要职责 |
|------|------|----------|
| 资源管理员 | 负责平台资源管理 | 导入平台数据、查看整体健康与优化建议、管理连接配置 |
| 运维工程师 | 负责日常运维 | 查看单台 VM 的指标与优化建议、执行优化操作 |
| 管理者 | 决策管理层 | 查看节省量、优化覆盖率等统计指标、查看整体报告 |

## 4. 功能需求

### 4.1 云平台数据采集 [FR-001]

**优先级：P0**

| 功能项 | 描述 |
|--------|------|
| FR-001-01 | 支持新增、编辑、测试 vCenter 连接 |
| FR-001-02 | 采集范围：集群/主机/VM 可选，支持批量选择 |
| FR-001-03 | 采集时段与粒度：支持指定时间窗与采样周期配置 |
| FR-001-04 | 输出：标准化 JSON 与 SQLite 落库 |
| FR-001-05 | 失败重试：指数退避重试机制 |
| FR-001-06 | 断点续采：支持中断后继续采集 |

**验收标准：**

- [ ] 完成连接测试并展示可用性结果
- [ ] 采集的数据结构符合统一数据模型
- [ ] 采集任务状态实时可查

### 4.2 数据清洗与处理 [FR-002]

**优先级：P0**

| 功能项 | 描述 |
|--------|------|
| FR-002-01 | 数据校验：缺失值、异常值、重复数据处理 |
| FR-002-02 | 单位归一：CPU、内存、磁盘 IO、网络指标统一口径 |
| FR-002-03 | 资源关系：集群、主机、VM 关系映射一致 |
| FR-002-04 | 清洗日志：记录清洗规则与处理结果 |

**验收标准：**

- [ ] 关键指标缺失可追溯并记录原因
- [ ] 异常数据可识别并可导出异常清单

### 4.3 僵尸虚拟机检测 [FR-003]

**优先级：P1**

| 功能项 | 描述 |
|--------|------|
| FR-003-01 | 支持多指标规则判定与阈值配置 |
| FR-003-02 | 检测指标：CPU、内存、磁盘 IO、网络活动 |
| FR-003-03 | 输出：检测结论、证据指标、置信度 |
| FR-003-04 | 支持白名单配置 |

**验收标准：**

- [ ] 报告中包含可追溯指标窗口与统计口径
- [ ] 置信度可解释
- [ ] 建议动作明确

### 4.4 资源配置评估（Right Size）[FR-004]

**优先级：P1**

| 功能项 | 描述 |
|--------|------|
| FR-004-01 | 评估 CPU、内存配置是否与使用水平匹配 |
| FR-004-02 | 基于 P95 使用率和超配率计算 |
| FR-004-03 | 输出：扩缩容建议、节省估算与风险提示 |
| FR-004-04 | 支持回滚建议 |

**验收标准：**

- [ ] 建议包含可执行的目标配置与估算节省
- [ ] 风险提示清晰

### 4.5 虚拟机潮汐检测 [FR-005]

**优先级：P2**

| 功能项 | 描述 |
|--------|------|
| FR-005-01 | 识别按时段/周期显著波动的负载模式 |
| FR-005-02 | 周期类型：日周期、周周期检测 |
| FR-005-03 | 输出：建议的启停时段与节省估算 |
| FR-005-04 | 周期稳定性评分 |

**验收标准：**

- [ ] 报告包含周期性证据与峰谷差
- [ ] 启停建议时间明确

### 4.6 平台资源健康检测 [FR-006]

**优先级：P2**

| 功能项 | 描述 |
|--------|------|
| FR-006-01 | 主机/集群整体健康评分 |
| FR-006-02 | 识别热点与瓶颈 |
| FR-006-03 | 输出：健康分与风险项，关联到主机或集群 |

**验收标准：**

- [ ] 健康评分可解释并关联到关键指标
- [ ] 风险项按严重度排序

### 4.7 报告与导出 [FR-007]

**优先级：P1**

| 功能项 | 描述 |
|--------|------|
| FR-007-01 | 支持报表导出：PDF/HTML/JSON |
| FR-007-02 | 支持任务级、实体级报告查询与筛选 |
| FR-007-03 | 报告包含趋势图与统计摘要 |
| FR-007-04 | 支持报告模板配置 |

**验收标准：**

- [ ] 报告格式正确，内容完整
- [ ] 导出功能稳定

## 5. 非功能需求

### 5.1 性能需求 [NFR-001]

| 指标 | 要求 |
|------|------|
| 数据采集 | 支持 1000+ VM 规模 |
| 分析响应 | 单 VM 分析 < 2 秒 |
| 报告生成 | 整体报告 < 30 秒 |
| 并发采集 | 支持 3 个并发采集任务 |

### 5.2 稳定性需求 [NFR-002]

| 指标 | 要求 |
|------|------|
| 后台采集 | 不影响用户交互 |
| 任务恢复 | 异常中断后可恢复 |
| 数据完整性 | 采集失败不丢失已采集数据 |

### 5.3 可维护性需求 [NFR-003]

| 指标 | 要求 |
|------|------|
| 模块化 | 采集、算法、报告模块解耦 |
| 算法可插拔 | 支持规则与模型扩展 |
| 日志完整 | 关键操作可追溯 |

### 5.4 可扩展性需求 [NFR-004]

| 指标 | 要求 |
|------|------|
| 新增平台 | 采集层适配器模式，支持新平台接入 |
| 新增算法 | 算法层插件化 |
| 数据模型 | 支持扩展字段 |

### 5.5 安全性需求 [NFR-005]

| 指标 | 要求 |
|------|------|
| 凭据存储 | 本地加密存储（AES-256） |
| 访问权限 | 遵循最小权限原则，仅读权限 |
| 日志脱敏 | 不记录明文凭据 |

### 5.6 兼容性需求 [NFR-006]

| 平台 | 支持情况 |
|------|----------|
| Windows | 支持 x86 |
| 麒麟 OS | 支持 x86/arm |
| 统信 UOS | 支持 x86/arm |
| macOS | 支持 x86/arm (Apple Silicon) |

## 6. 约束与假设

### 6.1 技术约束

| 约束项 | 说明 |
|--------|------|
| 开发框架 | Wails v2 (Go + Vue 3) |
| 数据库 | SQLite |
| vCenter API | govmomi SDK |

### 6.2 业务约束

| 约束项 | 说明 |
|--------|------|
| 采集权限 | 由用户提供并具备必要读权限 |
| 首期范围 | 仅支持 vCenter，H3C UIS 后续版本 |
| 执行模式 | 首期以离线导入与定时采集为主，不支持自动变更 |

### 6.3 假设条件

| 假设项 | 说明 |
|--------|------|
| 指标可用性 | 指标数据在平台侧可用 |
| 网络连通性 | 用户环境可访问目标平台 |
| 资源充足 | 本地运行环境有足够存储空间 |

## 7. 界面需求

### 7.1 页面结构

```
JustFit
├── 首页总览 (/)
├── 连接与采集 (/connections)
├── 分析结果
│   ├── 僵尸 VM (/analysis/zombie)
│   ├── Right Size (/analysis/rightsize)
│   ├── 潮汐检测 (/analysis/tidal)
│   └── 平台健康 (/analysis/health)
├── 报告与导出 (/reports)
├── 任务中心 (/tasks)
└── 系统设置 (/settings)
```

### 7.2 核心交互流程

**新增连接与采集流程：**

```
选择平台类型 → 填写连接信息 → 测试连接 → 保存 → 配置采集范围 → 启动任务
```

**分析报告流程：**

```
选择分析类型 → 选择分析范围 → 生成报告 → 查看详情 → 导出
```

## 8. 数据需求

### 8.1 采集数据范围

| 实体 | 数据类型 |
|------|----------|
| 集群 | 基本信息、资源总量、健康状态 |
| 主机 | 配置信息、资源使用情况 |
| 虚拟机 | 配置信息、时间序列指标 |
| 指标 | CPU、内存、磁盘 IO、网络 |

### 8.2 指标要求

| 指标 | 精度 | 采样周期 |
|------|------|----------|
| CPU 使用率 | % | 5 分钟 |
| 内存使用率 | % | 5 分钟 |
| 磁盘 IOPS | 次/秒 | 5 分钟 |
| 网络吞吐 | MB/s | 5 分钟 |

## 9. 验收标准

### 9.1 功能验收

| 验收项 | 标准 |
|--------|------|
| 数据采集成功率 | >= 98% |
| 指标缺失率 | 可追溯且可解释 |
| 报告生成 | 满足性能要求 |

### 9.2 非功能验收

| 验收项 | 标准 |
|--------|------|
| 后台采集 | 24 小时稳定运行 |
| 多平台支持 | 指定 OS/架构 可安装运行 |
| 安全性 | 凭据加密存储通过安全审计 |

## 10. 交付物清单

| 交付物 | 说明 |
|--------|------|
| 可执行安装包 | Windows/麒麟/统信/MacOS 多平台 |
| 数据库 Schema | SQL 脚本与文档 |
| 数据字典 | 字段定义与指标口径 |
| 报告模板 | PDF/HTML 模板文件 |
| 用户手册 | 操作指南 |
| 部署手册 | 安装与配置指南 |
| 运维手册 | 故障排查与维护 |

## 11. 变更记录

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|----------|------|
| v1.0 | 2026-02-07 | 初始版本 | - |
